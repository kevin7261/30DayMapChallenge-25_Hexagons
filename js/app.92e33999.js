(function(){"use strict";var e={6568:function(e,t,o){var a=o(5130),l=o(657),n=o(6768);const r={id:"app",class:"d-flex flex-column vh-100"},s={class:"d-flex flex-column overflow-hidden"};function i(e,t,o,a,l,i){const c=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("div",s,[(0,n.bF)(c)])])}var c={name:"App"},p=o(1241);const u=(0,p.A)(c,[["render",i]]);var d=u,f=o(1387);const g={class:"vh-100 vw-100 overflow-hidden"};function h(e,t,o,a,l,r){const s=(0,n.g2)("MapTab");return(0,n.uX)(),(0,n.CE)("div",g,[(0,n.bF)(s,{onMapReady:a.setMapInstance},null,8,["onMapReady"])])}var v=o(4232);const m={id:"map-container",class:"h-100 w-100 position-relative bg-transparent z-0"},y=["id"],b={class:"position-absolute",style:{top:"50%",left:"0",transform:"translateY(-50%)","z-index":"1000",padding:"1rem"}},M={class:"bg-dark bg-opacity-75 rounded-3 p-3"},T={class:""},w={class:"d-flex flex-column gap-1"};function x(e,t,o,a,l,r){return(0,n.uX)(),(0,n.CE)("div",m,[(0,n.Lk)("div",{id:a.mapContainerId,ref:"mapContainer",class:"h-100 w-100"},null,8,y),(0,n.Lk)("div",b,[(0,n.Lk)("div",M,[(0,n.Lk)("div",T,[(0,n.Lk)("div",w,[(0,n.Lk)("button",{type:"button",class:(0,v.C4)(["btn border-0 my-country-btn my-font-sm-white px-4 py-3",["map"===a.displayMode?"active":""]]),onClick:t[0]||(t[0]=e=>a.toggleDisplayMode("map"))}," åœ°åœ–æ¨¡å¼ ",2),(0,n.Lk)("button",{type:"button",class:(0,v.C4)(["btn border-0 my-country-btn my-font-sm-white px-4 py-3",["grid"===a.displayMode?"active":""]]),onClick:t[1]||(t[1]=e=>a.toggleDisplayMode("grid"))}," ç¶²æ ¼æ¨¡å¼ ",2),(0,n.Lk)("button",{type:"button",class:(0,v.C4)(["btn border-0 my-country-btn my-font-sm-white px-4 py-3",["cesium3d"===a.displayMode?"active":""]]),onClick:t[2]||(t[2]=e=>a.toggleDisplayMode("cesium3d"))}," CesiumJS 3Dæ¨¡å¼ ",2),(0,n.Lk)("button",{type:"button",class:(0,v.C4)(["btn border-0 my-country-btn my-font-sm-white px-4 py-3",["maplibre3d"===a.displayMode?"active":""]]),onClick:t[3]||(t[3]=e=>a.toggleDisplayMode("maplibre3d"))}," MapLibre 3Dæ¨¡å¼ ",2)])])])])])}o(8111),o(2489),o(116),o(7588),o(1701);var C=o(144),L=o(446);const k=(0,l.nY)("data",(()=>{const e=(0,C.KR)(null),t=t=>{e.value=t};return{mapInstance:e,setMapInstance:t}}),{persist:!0});var z=o(7326),D=o.n(z),S={name:"MapTab",emits:["map-ready"],setup(e,{emit:t}){k();const o=(0,C.KR)(null);let a=null,l=null,r=null,s=null,i=null,c=null,p=null,u=null;const d=(0,C.KR)(!1),f=(0,C.KR)(`leaflet-map-${Math.random().toString(36).substr(2,9)}`),g=(0,C.KR)("map"),h=(0,C.KR)(null),v=(0,C.KR)(null),m=((0,C.KR)(null),async()=>{try{console.log("[MapTab] é–‹å§‹è¼‰å…¥ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON æ•¸æ“š...");const e=await fetch("/30DayMapChallenge-25_Hexagons/data/geojson/ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š1140318.geojson");if(!e.ok)throw new Error(`ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šæ•¸æ“šè¼‰å…¥å¤±æ•—: HTTP ${e.status}`);return h.value=await e.json(),console.log("[MapTab] ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šæ•¸æ“šè¼‰å…¥æˆåŠŸ"),console.log("  - ç¸£å¸‚æ•¸é‡:",h.value.features?.length||0),!0}catch(e){return console.error("[MapTab] ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šæ•¸æ“šè¼‰å…¥å¤±æ•—:",e),!1}}),y=()=>{if(!o.value)return;const e=o.value.querySelector(".map-tooltip");e&&e.remove(),c=document.createElement("div"),c.className="map-tooltip",c.style.position="absolute",c.style.pointerEvents="none",c.style.opacity="0",c.style.padding="4px 8px",o.value.appendChild(c),console.log("[MapTab] å·¥å…·æç¤ºå…ƒç´ å‰µå»ºæˆåŠŸ")},b=async()=>{try{console.log("[MapTab] é–‹å§‹è¼‰å…¥å…­è§’å½¢ç¶²æ ¼ GeoJSON æ•¸æ“š...");const e=await fetch("/30DayMapChallenge-25_Hexagons/data/geojson/pointy_final_with_levels_over5.geojson");if(!e.ok)throw new Error(`å…­è§’å½¢ç¶²æ ¼æ•¸æ“šè¼‰å…¥å¤±æ•—: HTTP ${e.status}`);return v.value=await e.json(),console.log("[MapTab] å…­è§’å½¢ç¶²æ ¼æ•¸æ“šè¼‰å…¥æˆåŠŸ"),console.log("  - ç¶²æ ¼æ•¸é‡:",v.value.features?.length||0),!0}catch(e){return console.error("[MapTab] å…­è§’å½¢ç¶²æ ¼æ•¸æ“šè¼‰å…¥å¤±æ•—:",e),!1}},M=()=>{if(i&&h.value)try{console.log("[MapTab] é–‹å§‹ç¹ªè£½ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON"),i.selectAll(".county").data(h.value.features).enter().append("path").attr("d",r).attr("class","county").attr("fill","none").attr("stroke","#cccccc").attr("stroke-width",.5).attr("stroke-opacity",.6),console.log("[MapTab] ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON ç¹ªè£½å®Œæˆ")}catch(e){console.error("[MapTab] ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON ç¹ªè£½å¤±æ•—:",e)}else console.error("[MapTab] ç„¡æ³•ç¹ªè£½ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š: g=",!!i,"countyData=",!!h.value)},T=()=>{if(i&&v.value&&r)try{console.log("[MapTab] é–‹å§‹ç¹ªè£½å…­è§’å½¢ç¶²æ ¼ï¼ˆGrid æ¨¡å¼ï¼‰"),i.selectAll(".hex-grid").remove(),i.selectAll(".county").remove();const e=v.value.features.filter((e=>e.properties["äººå£æ•¸"]&&e.properties["äººå£æ•¸"]>0&&e.properties["ratio_China"]&&e.properties["ratio_China"]>0&&e.properties["level"]&&e.properties["level"]>=1&&e.properties["level"]<=5));console.log("[MapTab] ä½¿ç”¨ level åˆ†é¡æ•¸æ“š:",{total:v.value.features.length,valid:e.length});const t=["#f9d5d3","#f4a9a3","#ee6c5e","#de2910","#a51f0c"],a=e=>!e||e<1||e>5?"#f0f0f0":t[e-1],l=new Array(t.length).fill(0);e.forEach((e=>{const t=e.properties["level"];t>=1&&t<=5&&l[t-1]++}));const n=e.sort(((e,t)=>{const o=e.properties["level"]||0,a=t.properties["level"]||0;return o-a}));console.log("[DEBUG] Grid æ¨¡å¼ - ç¸½å…±è¦ç¹ªè£½çš„å…­è§’å½¢ç¶²æ ¼æ•¸:",n.length),console.log("[DEBUG] Grid æ¨¡å¼ - å‰ 5 å€‹ç¶²æ ¼:",n.slice(0,5).map((e=>({level:e.properties["level"],ratio_China:e.properties["ratio_China"],color:a(e.properties["level"])}))));const s=i.selectAll(".hex-grid").data(n).enter().append("path").attr("d",r).attr("class","hex-grid").attr("fill",(e=>a(e.properties["level"]))).attr("fill-opacity",.8).attr("stroke","#ffffff").attr("stroke-width",.5).style("cursor","pointer");console.log("[DEBUG] Grid æ¨¡å¼ - ç¹ªè£½äº†å¤šå°‘å€‹ path å…ƒç´ :",s.size()),s.on("mouseover",(function(e,t){if(L.Ltv(this).attr("fill-opacity",1).attr("stroke-width",2),c){const a=t.properties,l=(e,t)=>null===t||void 0===t?"N/A":e.startsWith("ratio_")&&"number"===typeof t?0===t?"0":t<1e-4?t.toExponential(2):t<.01?t.toFixed(5):t.toFixed(4):t;let n="";Object.keys(a).forEach((e=>{const t=a[e];n+=`<div><strong>${e}:</strong> ${l(e,t)}</div>`})),c.innerHTML=n;const[r,s]=L.WnM(e,o.value);c.style.left=r+10+"px",c.style.top=s-10+"px",c.style.opacity=1}})).on("mousemove",(function(e){if(c){const[t,a]=L.WnM(e,o.value);c.style.left=t+10+"px",c.style.top=a-10+"px"}})).on("mouseout",(function(){L.Ltv(this).attr("fill-opacity",.8).attr("stroke-width",.5),c&&(c.style.opacity=0)})),_(t,l),console.log("[MapTab] å…­è§’å½¢ç¶²æ ¼ï¼ˆGrid æ¨¡å¼ï¼‰ç¹ªè£½å®Œæˆ")}catch(e){console.error("[MapTab] å…­è§’å½¢ç¶²æ ¼ç¹ªè£½å¤±æ•—:",e)}else console.error("[MapTab] ç„¡æ³•ç¹ªè£½å…­è§’å½¢ç¶²æ ¼: g=",!!i,"hexData=",!!v.value,"path=",!!r)},w=async e=>{if(g.value=e,console.log("[MapTab] åˆ‡æ›é¡¯ç¤ºæ¨¡å¼:",e),"map"===g.value){if(h.value||await m(),v.value||await b(),a&&!l){try{s&&(a.on(".zoom",null),a.call(s.on("zoom",null)))}catch(t){console.warn("[MapTab] ç§»é™¤ zoom è¡Œç‚ºæ™‚å‡ºéŒ¯:",t)}a.remove(),a=null,i=null,s=null}if(l&&r)a&&s&&a.call(s.transform,L.GSI);else{const e=o.value.getBoundingClientRect();if(e.width>0&&e.height>0){const t=e.width,n=e.height;a&&(s&&(a.on(".zoom",null),a.on("mousedown.zoom",null),a.on("mousemove.zoom",null),a.on("mouseup.zoom",null),a.on("touchstart.zoom",null),a.on("touchmove.zoom",null),a.on("touchend.zoom",null),a.on("wheel.zoom",null)),a.remove(),a=null,i=null,s=null),a=L.Ltv(o.value).append("svg").attr("width",t).attr("height",n).style("background","#ffffff"),l=L.bAh().center([121,23.5]).scale(12e3).translate([t/2,n/2]),r=L.zFW().projection(l),i=a.append("g"),s=L.s_O().scaleExtent([.5,50]).on("zoom",(e=>{i&&i.attr("transform",e.transform)})),a.call(s),a.call(s.transform,L.GSI),y(),d.value=!0}}M(),E()}else if("grid"===g.value){if(v.value||await b(),h.value=null,a&&!l&&(s&&a.on(".zoom",null),a.remove(),a=null,i=null,s=null),l&&r)a&&s&&a.call(s.transform,L.GSI);else{const e=o.value.getBoundingClientRect();if(e.width>0&&e.height>0){const t=e.width,n=e.height;a&&(s&&(a.on(".zoom",null),a.on("mousedown.zoom",null),a.on("mousemove.zoom",null),a.on("mouseup.zoom",null),a.on("touchstart.zoom",null),a.on("touchmove.zoom",null),a.on("touchend.zoom",null),a.on("wheel.zoom",null)),a.remove(),a=null,i=null,s=null),a=L.Ltv(o.value).append("svg").attr("width",t).attr("height",n).style("background","#ffffff"),l=L.bAh().center([121,23.5]).scale(12e3).translate([t/2,n/2]),r=L.zFW().projection(l),i=a.append("g"),s=L.s_O().scaleExtent([.5,50]).on("zoom",(e=>{i&&i.attr("transform",e.transform)})),a.call(s),a.call(s.transform,L.GSI),y(),d.value=!0}}T()}else"cesium3d"===g.value?(v.value||await b(),x(),await z()):"maplibre3d"===g.value&&(v.value||await b(),x(),await S())},x=()=>{if(a){try{s&&a.on(".zoom",null),a.remove()}catch(e){console.warn("[MapTab] æ¸…ç† SVG æ™‚å‡ºéŒ¯:",e)}a=null,i=null,s=null,l=null,r=null}if(p){try{p.destroy()}catch(e){console.warn("[MapTab] æ¸…ç† Cesium Viewer æ™‚å‡ºéŒ¯:",e)}p=null}if(u){try{u.remove()}catch(e){console.warn("[MapTab] æ¸…ç† MapLibre Map æ™‚å‡ºéŒ¯:",e)}u=null}o.value&&(o.value.innerHTML="")},z=async()=>{try{if(console.log("[MapTab] é–‹å§‹åˆå§‹åŒ– CesiumJS 3D åœ°åœ–"),!o.value||!v.value)return void console.error("[MapTab] ç„¡æ³•åˆå§‹åŒ– CesiumJS: å®¹å™¨æˆ–æ•¸æ“šä¸å­˜åœ¨");if("undefined"===typeof window.Cesium)return void console.error("[MapTab] CesiumJS å°šæœªè¼‰å…¥ï¼Œè«‹ç¢ºä¿å·²å¼•å…¥ CDN è…³æœ¬");const e=window.Cesium;e.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxYjJiZjlhZC1mZDNkLTRiZWEtYjExNy1iZDI1OWQ5ZmJlZmEiLCJpZCI6MzU1MDgxLCJpYXQiOjE3NjE3MTc5NTl9.ivNUz20WJNOvyTB6vzB8xHNWNSzgl06vBAGOuZLNKs4";const t=await e.createWorldTerrainAsync();p=new e.Viewer(o.value,{terrainProvider:t,baseLayerPicker:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,animation:!1,fullscreenButton:!1,vrButton:!1,navigationHelpButton:!1}),p.camera.setView({destination:e.Cartesian3.fromDegrees(121,23.5,5e5),orientation:{heading:0,pitch:-.5,roll:0}});const a=t=>{const o={1:e.Color.fromCssColorString("#f9d5d3"),2:e.Color.fromCssColorString("#f4a9a3"),3:e.Color.fromCssColorString("#ee6c5e"),4:e.Color.fromCssColorString("#de2910"),5:e.Color.fromCssColorString("#a51f0c")};return o[t]||e.Color.fromCssColorString("#f0f0f0")},l=()=>{if(!v.value||!v.value.features||0===v.value.features.length)return 6e3;const e=v.value.features.find((e=>e.properties.level>=1&&e.properties.level<=5&&e.geometry&&e.geometry.coordinates[0]));if(!e||!e.geometry.coordinates[0])return 6e3;const t=e.geometry.coordinates[0];if(t.length<4)return 6e3;const o=t[0],a=t[3],l=6371e3,n=o[1]*Math.PI/180,r=a[1]*Math.PI/180,s=(a[1]-o[1])*Math.PI/180,i=(a[0]-o[0])*Math.PI/180,c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(r)*Math.sin(i/2)*Math.sin(i/2),p=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),u=l*p;return console.log("[MapTab] CesiumJS 3D - è¨ˆç®—çš„å…­è§’å½¢å¯¬åº¦ï¼ˆç±³ï¼‰:",u),u},n=l(),r=e=>!e||e<1||e>5?0:e*n,s=v.value.features.filter((e=>e.properties.level&&e.properties.level>=1&&e.properties.level<=5&&e.geometry&&"Polygon"===e.geometry.type));console.log("[MapTab] CesiumJS 3D - æœ‰æ•ˆçš„ features æ•¸é‡:",s.length),s.forEach((t=>{const o=t.properties.level,l=t.geometry.coordinates[0],n=r(o),s=l.map((t=>e.Cartesian3.fromDegrees(t[0],t[1],0)));p.entities.add({polygon:{hierarchy:s,material:a(o).withAlpha(.8),height:0,extrudedHeight:n,outline:!1},properties:t.properties})}));const i=new e.ScreenSpaceEventHandler(p.scene.canvas);i.setInputAction((t=>{const o=p.scene.pick(t.position);if(e.defined(o)&&o.id&&o.id.properties){const e=o.id.properties;let t="Properties:\n";for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t+=`${o}: ${e[o].getValue()}\n`);console.log("[MapTab] CesiumJS - é»æ“Šçš„å¯¦é«”ä¿¡æ¯:",t)}}),e.ScreenSpaceEventType.LEFT_CLICK),d.value=!0,console.log("[MapTab] CesiumJS 3D åœ°åœ–åˆå§‹åŒ–å®Œæˆ")}catch(e){console.error("[MapTab] CesiumJS 3D åœ°åœ–åˆå§‹åŒ–å¤±æ•—:",e)}},S=async()=>{try{if(console.log("[MapTab] é–‹å§‹åˆå§‹åŒ– MapLibre GL 3D åœ°åœ–"),!o.value||!v.value)return void console.error("[MapTab] ç„¡æ³•åˆå§‹åŒ– MapLibre GL: å®¹å™¨æˆ–æ•¸æ“šä¸å­˜åœ¨");u=new(D().Map)({container:o.value,style:{version:8,sources:{carto:{type:"raster",tiles:["https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://b.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://c.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"],tileSize:256,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'}},layers:[{id:"carto-dark-layer",type:"raster",source:"carto",minzoom:0,maxzoom:22}]},center:[121,23.5],zoom:8,pitch:45,bearing:0,antialias:!0}),u.on("load",(()=>{console.log("[MapTab] MapLibre GL åœ°åœ–è¼‰å…¥å®Œæˆ");const e=()=>{if(!v.value||!v.value.features||0===v.value.features.length)return 6e3;const e=v.value.features.find((e=>e.properties.level>=1&&e.properties.level<=5&&e.geometry&&e.geometry.coordinates[0]));if(!e||!e.geometry.coordinates[0])return 6e3;const t=e.geometry.coordinates[0];if(t.length<4)return 6e3;const o=t[0],a=t[3],l=6371e3,n=o[1]*Math.PI/180,r=a[1]*Math.PI/180,s=(a[1]-o[1])*Math.PI/180,i=(a[0]-o[0])*Math.PI/180,c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(r)*Math.sin(i/2)*Math.sin(i/2),p=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),u=l*p;return console.log("[MapTab] MapLibre GL 3D - è¨ˆç®—çš„å…­è§’å½¢å¯¬åº¦ï¼ˆç±³ï¼‰:",u),u},t=e(),o=e=>!e||e<1||e>5?0:e*t,a=e=>{const t={1:"#f9d5d3",2:"#f4a9a3",3:"#ee6c5e",4:"#de2910",5:"#a51f0c"};return t[e]||"#f0f0f0"},l=v.value.features.filter((e=>e.properties.level&&e.properties.level>=1&&e.properties.level<=5&&e.geometry&&"Polygon"===e.geometry.type)).map((e=>{const t=e.properties.level,l=o(t);return{...e,properties:{...e.properties,base_height:l,color:a(t)}}}));console.log("[MapTab] MapLibre GL 3D - æœ‰æ•ˆçš„ features æ•¸é‡:",l.length),u.addSource("hexagons-3d",{type:"geojson",data:{type:"FeatureCollection",features:l}}),u.addLayer({id:"hexagons-3d-fill",type:"fill-extrusion",source:"hexagons-3d",paint:{"fill-extrusion-color":["get","color"],"fill-extrusion-height":["get","base_height"],"fill-extrusion-base":0,"fill-extrusion-opacity":.8}}),u.on("click","hexagons-3d-fill",(e=>{const t=e.features[0].properties;console.log("[MapTab] MapLibre GL - é»æ“Šçš„å¯¦é«”ä¿¡æ¯:",t),(new(D().Popup)).setLngLat(e.lngLat).setHTML(Object.keys(t).map((e=>`<strong>${e}:</strong> ${t[e]}`)).join("<br>")).addTo(u)})),u.on("mouseenter","hexagons-3d-fill",(()=>{u.getCanvas().style.cursor="pointer"})),u.on("mouseleave","hexagons-3d-fill",(()=>{u.getCanvas().style.cursor=""})),d.value=!0,console.log("[MapTab] MapLibre GL 3D åœ°åœ–åˆå§‹åŒ–å®Œæˆ")})),u.on("error",(e=>{console.error("[MapTab] MapLibre GL åœ°åœ–è¼‰å…¥éŒ¯èª¤:",e)}))}catch(e){console.error("[MapTab] MapLibre GL 3D åœ°åœ–åˆå§‹åŒ–å¤±æ•—:",e)}},E=()=>{if(i&&v.value&&r)try{console.log("[MapTab] é–‹å§‹ç¹ªè£½å…­è§’å½¢ç¶²æ ¼ GeoJSON"),i.selectAll(".hex-grid").remove();const e=v.value.features.filter((e=>e.properties["äººå£æ•¸"]&&e.properties["äººå£æ•¸"]>0&&e.properties["ratio_China"]&&e.properties["ratio_China"]>0&&e.properties["level"]&&e.properties["level"]>=1&&e.properties["level"]<=5));console.log("[MapTab] ä½¿ç”¨ level åˆ†é¡æ•¸æ“š:",{total:v.value.features.length,valid:e.length});const t=["#f9d5d3","#f4a9a3","#ee6c5e","#de2910","#a51f0c"],a=e=>!e||e<1||e>5?"#f0f0f0":t[e-1],l=new Array(t.length).fill(0);e.forEach((e=>{const t=e.properties["level"];t>=1&&t<=5&&l[t-1]++}));const n=e.sort(((e,t)=>{const o=e.properties["level"]||0,a=t.properties["level"]||0;return o-a}));console.log("[DEBUG] ç¸½å…±è¦ç¹ªè£½çš„å…­è§’å½¢ç¶²æ ¼æ•¸:",n.length),console.log("[DEBUG] å‰ 5 å€‹ç¶²æ ¼:",n.slice(0,5).map((e=>({level:e.properties["level"],ratio_China:e.properties["ratio_China"],color:a(e.properties["level"])})))),console.log("[MapTab] ä½¿ç”¨ Map æ¨¡å¼ç¹ªè£½ï¼ˆåœ°åœ–æŠ•å½±ï¼‰"),console.log("[MapTab] path generator:",!!r,"g:",!!i);const s=i.selectAll(".hex-grid").data(n).enter().append("path").attr("d",r).attr("class","hex-grid").attr("fill",(e=>a(e.properties["level"]))).attr("fill-opacity",.8).attr("stroke","#ffffff").attr("stroke-width",.5).style("cursor","pointer");console.log("[DEBUG] ç¹ªè£½äº†å¤šå°‘å€‹ path å…ƒç´ :",s.size()),s.on("mouseover",(function(e,t){if(L.Ltv(this).attr("fill-opacity",1).attr("stroke-width",2),c){const a=t.properties,l=(e,t)=>null===t||void 0===t?"N/A":e.startsWith("ratio_")&&"number"===typeof t?0===t?"0":t<1e-4?t.toExponential(2):t<.01?t.toFixed(5):t.toFixed(4):t;let n="";Object.keys(a).forEach((e=>{const t=a[e];n+=`<div><strong>${e}:</strong> ${l(e,t)}</div>`})),c.innerHTML=n;const[r,s]=L.WnM(e,o.value);c.style.left=r+10+"px",c.style.top=s-10+"px",c.style.opacity=1}})).on("mousemove",(function(e){if(c){const[t,a]=L.WnM(e,o.value);c.style.left=t+10+"px",c.style.top=a-10+"px"}})).on("mouseout",(function(){L.Ltv(this).attr("fill-opacity",.8).attr("stroke-width",.5),c&&(c.style.opacity=0)})),_(t,l),console.log("[MapTab] å…­è§’å½¢ç¶²æ ¼ï¼ˆåœ°åœ–æ¨¡å¼ï¼‰ç¹ªè£½å®Œæˆ"),console.log("  - ä½¿ç”¨ level åˆ†é¡ (1-5)"),console.log("  - SVG ä¸­çš„ path å…ƒç´ æ•¸é‡:",i.selectAll("path").size()),console.log("  - hex-grid class å…ƒç´ æ•¸é‡:",i.selectAll(".hex-grid").size())}catch(e){console.error("[MapTab] ç™»é©ç†±ç¶²æ ¼ç¹ªè£½å¤±æ•—:",e)}else console.error("[MapTab] ç„¡æ³•ç¹ªè£½å…­è§’å½¢ç¶²æ ¼: g=",!!i,"hexData=",!!v.value,"path=",!!r)},_=(e,t)=>{if(!a||!o.value)return;a.selectAll(".legend").remove();const l=280,n=24,r=15,s=28,i=o.value.getBoundingClientRect(),c=i.width,p=i.height,u=c-l-r,d=p-n-120,f=a.append("g").attr("class","legend").attr("data-legend-x",u).attr("data-legend-y",d).attr("transform",`translate(${u}, ${d})`);f.selectAll(".legend-color").data(e).enter().append("rect").attr("class","legend-color").attr("x",((t,o)=>o*(l/e.length))).attr("y",0).attr("width",l/e.length).attr("height",n).attr("fill",(e=>e)).attr("stroke","#333").attr("stroke-width",1);const g=[1,2,3,4,5];f.selectAll(".legend-label").data(g).enter().append("text").attr("class","legend-label").attr("x",((e,t)=>(t+.5)*(l/g.length))).attr("y",n+s).attr("font-size","12px").attr("fill","#333").attr("text-anchor","middle").text((e=>`Level ${e}`)),t&&f.selectAll(".legend-count").data(t).enter().append("text").attr("class","legend-count").attr("x",((e,o)=>(o+.5)*(l/t.length))).attr("y",n+2*s).attr("font-size","11px").attr("fill","#666").attr("text-anchor","middle").text((e=>e)),f.append("text").attr("class","legend-title").attr("x",l/2).attr("y",-12).attr("font-size","13px").attr("font-weight","bold").attr("fill","#333").attr("text-anchor","middle").text("ratio_China (æ¯”ä¾‹å€¼) - Level")},G=()=>{if(!o.value)return!1;const e=o.value.getBoundingClientRect();if(0===e.width||0===e.height)return console.warn("[MapTab] å®¹å™¨å°ºå¯¸ç‚ºé›¶ï¼Œå»¶é²åˆå§‹åŒ–"),!1;try{const n=e.width,c=e.height;return a=L.Ltv(o.value).append("svg").attr("width",n).attr("height",c).style("background","#ffffff"),l=L.bAh().center([121,23.5]).scale(12e3).translate([n/2,c/2]),r=L.zFW().projection(l),i=a.append("g"),s=L.s_O().scaleExtent([.5,50]).on("zoom",(e=>{i&&i.node()&&i.node().parentNode&&i.attr("transform",e.transform)})),a.call(s),a.call(s.transform,L.GSI),y(),d.value=!0,t("map-ready",{svg:a,projection:l,path:r}),console.log("[MapTab] D3.js åœ°åœ–å‰µå»ºæˆåŠŸ"),!0}catch(n){return console.error("[MapTab] D3.js åœ°åœ–å‰µå»ºå¤±æ•—:",n),!1}},I=async()=>{let e=0;const t=20;if("map"===g.value){console.log("[MapTab] é–‹å§‹è¼‰å…¥åœ°åœ–æ¨¡å¼æ•¸æ“š...");const[o,a]=await Promise.all([m(),b()]);if(!o)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šæ•¸æ“š");if(!a)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥å…­è§’å½¢ç¶²æ ¼æ•¸æ“š");console.log("[MapTab] æ‰€æœ‰æ•¸æ“šè¼‰å…¥å®Œæˆï¼Œé–‹å§‹å‰µå»ºåœ°åœ–");const l=async()=>{e>=t?console.error("[MapTab] åœ°åœ–åˆå§‹åŒ–å¤±æ•—ï¼Œå·²é”åˆ°æœ€å¤§å˜—è©¦æ¬¡æ•¸"):(e++,console.log(`[MapTab] å˜—è©¦å‰µå»ºåœ°åœ– (${e}/${t})`),G()?(console.log("[MapTab] åœ°åœ–å‰µå»ºæˆåŠŸï¼Œé–‹å§‹ç¹ªè£½åœ–å±¤"),M(),E()):(console.log("[MapTab] åœ°åœ–å‰µå»ºå¤±æ•—ï¼Œ100ms å¾Œé‡è©¦"),setTimeout(l,100)))};l()}else if("grid"===g.value){console.log("[MapTab] é–‹å§‹è¼‰å…¥ç¶²æ ¼æ¨¡å¼æ•¸æ“š...");const o=await b();if(!o)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥å…­è§’å½¢ç¶²æ ¼æ•¸æ“š");console.log("[MapTab] æ•¸æ“šè¼‰å…¥å®Œæˆï¼Œé–‹å§‹å‰µå»ºç¶²æ ¼è¦–åœ–");const a=async()=>{e>=t?console.error("[MapTab] ç¶²æ ¼åˆå§‹åŒ–å¤±æ•—ï¼Œå·²é”åˆ°æœ€å¤§å˜—è©¦æ¬¡æ•¸"):(e++,console.log(`[MapTab] å˜—è©¦å‰µå»ºç¶²æ ¼è¦–åœ– (${e}/${t})`),G()?(console.log("[MapTab] ç¶²æ ¼è¦–åœ–å‰µå»ºæˆåŠŸï¼Œé–‹å§‹ç¹ªè£½å…­è§’å½¢ç¶²æ ¼"),T()):(console.log("[MapTab] ç¶²æ ¼è¦–åœ–å‰µå»ºå¤±æ•—ï¼Œ100ms å¾Œé‡è©¦"),setTimeout(a,100)))};a()}else if("cesium3d"===g.value){console.log("[MapTab] é–‹å§‹è¼‰å…¥ CesiumJS 3D æ¨¡å¼æ•¸æ“š...");const e=await b();if(!e)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥å…­è§’å½¢ç¶²æ ¼æ•¸æ“š");console.log("[MapTab] æ•¸æ“šè¼‰å…¥å®Œæˆï¼Œé–‹å§‹åˆå§‹åŒ– CesiumJS 3D åœ°åœ–"),x(),await z()}else if("maplibre3d"===g.value){console.log("[MapTab] é–‹å§‹è¼‰å…¥ MapLibre 3D æ¨¡å¼æ•¸æ“š...");const e=await b();if(!e)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥å…­è§’å½¢ç¶²æ ¼æ•¸æ“š");console.log("[MapTab] æ•¸æ“šè¼‰å…¥å®Œæˆï¼Œé–‹å§‹åˆå§‹åŒ– MapLibre 3D åœ°åœ–"),x(),await S()}};let O=null;const A=()=>{O&&clearTimeout(O),O=setTimeout((()=>{console.log("[MapTab] çª—å£å¤§å°èª¿æ•´ï¼Œé‡æ–°ç¹ªè£½åœ°åœ–"),I()}),300)};return(0,n.sV)((()=>{(0,n.dY)((()=>{I()})),window.addEventListener("resize",A)})),(0,n.hi)((()=>{if(O&&clearTimeout(O),window.removeEventListener("resize",A),a){try{s&&(a.on(".zoom",null),a.call(s.on("zoom",null)))}catch(e){console.warn("[MapTab] ç§»é™¤ zoom è¡Œç‚ºæ™‚å‡ºéŒ¯:",e)}a.remove(),a=null,i=null,s=null}if(c&&(c.remove(),c=null),p){try{p.destroy()}catch(e){console.warn("[MapTab] æ¸…ç† Cesium Viewer æ™‚å‡ºéŒ¯:",e)}p=null}if(u){try{u.remove()}catch(e){console.warn("[MapTab] æ¸…ç† MapLibre Map æ™‚å‡ºéŒ¯:",e)}u=null}l=null,r=null,s=null,i=null,d.value=!1})),{mapContainer:o,mapContainerId:f,displayMode:g,toggleDisplayMode:w}}};const E=(0,p.A)(S,[["render",x],["__scopeId","data-v-00806bff"]]);var _=E,G={name:"HomeView",components:{MapTab:_},setup(){const e=k(),t=t=>e.setMapInstance(t);return{setMapInstance:t}}};const I=(0,p.A)(G,[["render",h]]);var O=I;const A=[{path:"/",name:"Home",component:O}],j=(0,f.aE)({history:(0,f.LA)("/30DayMapChallenge-25_Hexagons/"),routes:A});var J=j;o(323);console.log("ğŸ¨ æ¨£å¼æ–‡ä»¶è¼‰å…¥å®Œæˆ");const P=(0,a.Ef)(d),N=(0,l.Ey)();P.use(J),P.use(N),P.mount("#app"),console.log("ğŸš€ ç©ºé–“åˆ†æè¦–è¦ºåŒ–å¹³å°å·²å•Ÿå‹•"),console.log("ğŸ“¦ Pinia ç‹€æ…‹ç®¡ç†å·²åˆå§‹åŒ–"),console.log("ğŸ—ºï¸ Vue Router è·¯ç”±ç³»çµ±å·²å°±ç·’"),console.log("ğŸ¨ Bootstrap 5 UI æ¡†æ¶å·²è¼‰å…¥"),console.log("ğŸ—ºï¸ D3.js åœ°åœ–åº«å·²æº–å‚™å°±ç·’"),console.log("ğŸ”¤ Font Awesome åœ–ç¤ºåº«å·²è¼‰å…¥")}},t={};function o(a){var l=t[a];if(void 0!==l)return l.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,a,l,n){if(!a){var r=1/0;for(p=0;p<e.length;p++){a=e[p][0],l=e[p][1],n=e[p][2];for(var s=!0,i=0;i<a.length;i++)(!1&n||r>=n)&&Object.keys(o.O).every((function(e){return o.O[e](a[i])}))?a.splice(i--,1):(s=!1,n<r&&(r=n));if(s){e.splice(p--,1);var c=l();void 0!==c&&(t=c)}}return t}n=n||0;for(var p=e.length;p>0&&e[p-1][2]>n;p--)e[p]=e[p-1];e[p]=[a,l,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var l,n,r=a[0],s=a[1],i=a[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(l in s)o.o(s,l)&&(o.m[l]=s[l]);if(i)var p=i(o)}for(t&&t(a);c<r.length;c++)n=r[c],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(p)},a=self["webpackChunk_30DayMapChallenge_25_Hexagons"]=self["webpackChunk_30DayMapChallenge_25_Hexagons"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(6568)}));a=o.O(a)})();
//# sourceMappingURL=app.92e33999.js.map